function inicjalizacjaKaruzeli(){document.querySelectorAll(".carousel").forEach((e=>{let t=e.getElementsByClassName("slide");t.length>0&&(t[0].classList.add("active"),e.dataset.currentSlide=0)}))}function zmienZdjecie(e,t){const n=document.getElementById(t);if(n){const t=n.getElementsByClassName("slide");let a=parseInt(n.dataset.currentSlide)||0;t.length>0&&(t[a].classList.remove("active"),a=(a+e+t.length)%t.length,t[a].classList.add("active"),n.dataset.currentSlide=a)}}function updateCeny(e){document.getElementById("price-label").textContent=`${e} zł`}function inicjalizowanieFiltrow(){const e=document.getElementById("price-range"),t=document.getElementById("brand-select"),n=document.getElementById("type-select"),a=document.getElementById("year-from-select"),r=document.getElementById("year-to-select"),i=document.getElementById("sorting-select");e&&t&&n&&a&&r&&(e.addEventListener("input",(()=>{updateCeny(e.value),filterOffers()})),t.addEventListener("change",filterOffers),n.addEventListener("change",filterOffers),a.addEventListener("change",filterOffers),r.addEventListener("change",filterOffers),i.addEventListener("change",(()=>{zapiszOpcjeSortowania(),sortowanieOfert()}))),zaladujOpcjeSortowania(),filterOffers()}function zapiszOpcjeSortowania(){const e=document.getElementById("sorting-select").value;localStorage.setItem("sortOption",e)}function zaladujOpcjeSortowania(){const e=localStorage.getItem("sortOption");e&&(document.getElementById("sorting-select").value=e)}function sortowanieOfert(){const e=document.getElementById("sorting-select").value,t=document.getElementById("offers-container"),n=Array.from(t.getElementsByClassName("offer"));n.sort(((t,n)=>{const a=parseInt(t.getAttribute("data-price")),r=parseInt(n.getAttribute("data-price"));return"od najniższej"===e?a-r:"od najwyższej"===e?r-a:0})),t.innerHTML="",n.forEach((e=>t.appendChild(e)))}function filterOffers(){const e=parseInt(document.getElementById("price-range").value),t=document.getElementById("brand-select").value,n=document.getElementById("type-select").value,a=document.getElementById("year-from-select").value,r=document.getElementById("year-to-select").value;document.getElementById("offers-container").querySelectorAll(".offer").forEach((i=>{const o=parseInt(i.getAttribute("data-price")),l=i.getAttribute("data-brand"),s=i.getAttribute("data-type"),c=parseInt(i.getAttribute("data-year"));let d=!0;o>e&&(d=!1),"all"!==t&&l!==t&&(d=!1),"all"!==n&&s!==n&&(d=!1),"all"!==a&&c<parseInt(a)&&(d=!1),"all"!==r&&c>parseInt(r)&&(d=!1),i.style.display=d?"block":"none"})),sortowanieOfert()}function zaladujOferty(){let e=JSON.parse(localStorage.getItem("offers"))||[];const t=document.getElementById("offers-container");t.innerHTML="",e.forEach(((e,n)=>{const a=document.createElement("div");a.className="offer",a.setAttribute("data-price",e.price),a.setAttribute("data-brand",e.brand),a.setAttribute("data-type",e.type),a.setAttribute("data-year",e.year);const r="carousel"+n;a.innerHTML=`\n            <div class="carousel" id="${r}">\n                <button class="prev" onclick="zmienZdjecie(-1, '${r}')">&#10094;</button>\n                ${e.images&&Array.isArray(e.images)?e.images.map(((e,t)=>`\n                    <img src="${e.trim()}" alt="Oferta ${t+1}" class="slide ${0===t?"active":""}">\n                `)).join(""):""}\n                <button class="next" onclick="zmienZdjecie(1, '${r}')">&#10095;</button>\n            </div>\n            <p class="cena">Cena: ${e.price}zł + VAT/miesiąc</p>\n            <button class="accordion">OPIS</button>\n            <div class="panel">\n                <p><strong>Marka:</strong> ${e.brand}</p>\n                <p><strong>Rok produkcji:</strong> ${e.year}</p>\n                <p><strong>VIN:</strong> ${e.vin}</p>\n                <p><strong>Typ naczepy:</strong> ${e.type}</p>\n            </div>\n            <div id="formularz-kontaktowy">\n                <button class="accordion">Skontaktuj się z nami i wynajmij naczepę już dziś:</button>\n                <div class="panel">\n                     <form action="mailto:pbtrans@gmail.com" method="post" enctype="text/plain">\n                        <label for="email">Twój email:</label>\n                        <input type="email" id="email" name="email" required>\n                        <label for="temat">Temat:</label>\n                        <input type="text" id="temat" name="temat">\n                        <label for="message">Treść wiadomości:</label>\n                        <textarea id="message" name="message" rows="4" required></textarea>\n                        <button type="submit">Wyślij</button>\n                    </form>\n                </div>\n            </div>\n        `,t.appendChild(a)})),inicjalizacjaKaruzeli(),inicjalizacjaAkordeonow()}document.addEventListener("DOMContentLoaded",(function(){inicjalizowanieFiltrow(),zaladujOferty()}));